<!doctype html>
<html th:attr="lang=${lang}" xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="">
		<title th:text="#{odontogram.title}">Odontogram</title>
		<link th:href="@{/webjars/bootstrap/css/bootstrap.min.css}" rel="stylesheet" />
		<link th:href="@{/css/main.css}" rel="stylesheet" />
	</head>
	
	<body>
		<div th:replace="~{fragments/navigation :: navigation}"></div>  
	
		<main class="container">
			<div class="bg-body-tertiary p-5 rounded">
				<h1><span th:text="#{odontogram.header}">Odontogram</span></h1>
				
				<div>
					<form action="#" th:action="@{/odontogram}" th:object="${odontogram}" method="post" novalidate>
						<div class="row g-3">
						
							<div class="col-sm-12">
								<label for="owner" class="form-label" th:text="#{owner}">Owner</label>:
								<select class="form-select" id="owner" name="owner" th:onchange="changeOwner()">
					                <option value="" th:text="#{label.select}"></option>
					                <option th:each="owner : ${owners}" 
					                	th:value="${owner.id}"
					                	th:text="${owner.name}">
					                	Select...
					                </option>
					            </select>
							</div>	
							
							<div class="col-sm-12">
								<label for="owner" class="form-label" th:text="#{animal}">Animal</label>:
								<select class="form-select" id="animal" name="animal">
					                <option value="" th:text="#{label.select}"></option>
					            </select>
							</div>		

							<div class="col-sm-3">
								<label for="checkUpDate" class="form-label" th:text="#{odontogram.checkUpDate}">CheckUpDate</label>:
								<input type="date" class="form-control" th:errorclass="is-invalid" 
									id="checkUpDate" th:field="*{checkUpDate}" aria-describedby="checkUpDateServerValidationFeedback" required>
								<div id="checkUpDateServerValidationFeedback" class="invalid-feedback" th:errors="*{checkUpDate}">
									checkUpDate invalid
								</div>
							</div>
							
							<div class="col-sm-12">
								<img src="images/odontogram.jpg" th:src="@{/images/odontogram.jpg}" class="img-fluid" />
							</div>
							
							<div class="col-sm-12">
								<label for="anamnesis" class="form-label" th:text="#{odontogram.anamnesis}">Anamnesis</label>:
								<textarea class="form-control" th:field="*{anamnesis}" th:errorclass="is-invalid" 
									aria-describedby="anamnesisServerValidationFeedback"></textarea>
								<div id="anamnesisFeedback" class="invalid-feedback" th:errors="*{anamnesis}">
									anamnesis invalid
								</div>							
							</div>
							
							
							<table class="table">
							  <thead>
							    <tr>
							      <th scope="col"><label th:text="#{odontogram.teethWolf}">Wolf Teeth</label></th>
							      <th scope="col"><label th:text="#{odontogram.teethIncisors}">Incisors</label></th>
							      <th scope="col"><label th:text="#{odontogram.canines}">Canines</label></th>
							      <th scope="col"><label th:text="#{odontogram.molars}">Molars</label></th>
							    </tr>
							  </thead>
							  <tbody>
							    <tr>
							      <td><label th:text="#{odontogram.teethWolfPresent}">Presents</label>:</td>
							      <td><label th:text="#{odontogram.standard}">Normal</label>:</td>
							      <td><label th:text="#{odontogram.present}">Presents</label>:</td>
							      <td><label th:text="#{odontogram.hooks.rostr}">Hooks rostr</label>:</td>
							    </tr>
							    <tr>
							      <td><label th:text="#{odontogram.teethWolfIncluded}">Included</label>:</td>
							      <td><label th:text="#{odontogram.curv.ventr}">curv.ventr</label>:</td>
							      <td><label th:text="#{odontogram.included}">Included</label>:</td>
							      <td><label th:text="#{odontogram.hooks.caud}">Hooks caud</label>:</td>
							    </tr>
							    <tr>
							      <td><label th:text="#{odontogram.teethWolfExtraction}">Extraction</label>:</td>
							      <td><label th:text="#{odontogram.curv.dors}">curv.dors</label>:</td>
							      <td><label th:text="#{odontogram.calculations}">Calculations</label>:</td>
							      <td><label th:text="#{odontogram.ramp.rostr}">Ramp Rostr</label>:</td>
							    </tr>
							    <tr>
							      <td></td>
							      <td><label th:text="#{odontogram.diagonal}">Diagonal</label>:</td>
							      <td><label th:text="#{odontogram.cutAndPol}">cutAndPol</label>:</td>
							      <td><label th:text="#{odontogram.ramp.caud}">Ramp Caud</label>:</td>
							    </tr>	
							    <tr>
							      <td></td>
							      <td><label th:text="#{odontogram.deciduous}">Deciduous</label>:</td>
							      <td></td>
							      <td><label th:text="#{odontogram.step}">Step</label>:</td>
							    </tr>	
							    <tr>
							      <td></td>
							      <td><label th:text="#{odontogram.fractured}">Fractured</label>:</td>
							      <td></td>
							      <td><label th:text="#{odontogram.wave}">Wave</label>:</td>
							    </tr>
							    <tr>
							      <td></td>
							      <td></td>
							      <td></td>
							      <td><label th:text="#{odontogram.shear.mouth}">Shear Mouth</label>:</td>
							    </tr>
							    <tr>
							      <td></td>
							      <td></td>
							      <td></td>
							      <td><label th:text="#{odontogram.deciduous}">Deciduous</label>:</td>
							    </tr>								        						    							    
							  </tbody>
							</table>							
							
							<div class="col-sm-12">
								<label for="procedures" class="form-label" th:text="#{odontogram.procedures}">Procedures</label>:
								<textarea class="form-control" th:field="*{procedures}" th:errorclass="is-invalid" 
									aria-describedby="proceduresServerValidationFeedback"></textarea>								
								<div id="proceduresFeedback" class="invalid-feedback" th:errors="*{procedures}">
									Procedures invalid
								</div>
							</div>							
							
							<div class="col-sm-12">
								<label for="recommendations" class="form-label" th:text="#{odontogram.recommendations}">Recomendations</label>:
								<textarea class="form-control" th:field="*{recommendations}" th:errorclass="is-invalid" 
									aria-describedby="recommendationsServerValidationFeedback"></textarea>									
								<div id="recommendationsFeedback" class="invalid-feedback" th:errors="*{recommendations}">
									Recommendations invalid
								</div>
							</div>
							
														
						</div>
						<hr class="my-4">
						<button class="btn btn-primary" type="submit" th:text="#{btn.save}" disabled>Save</button>
					</form>
				</div>
				    
			</div>
		</main>
		
		<div th:replace="~{fragments/footer :: footer}"></div>
		
		<script type="text/javascript">
		
			function changeOwner() {
			    var selectedOwner = $( "#owner option:selected" ).val();
			    var animalSelect = $("#animal");
			    if (selectedOwner !== ""){
				    $.getJSON("/owner/" + selectedOwner + "/animals", function(data, status){
			    	  var options = [];
			    	  $.each(data, function (key, val) {
			    		  options.push("<option value='" + this.id + "'>" + this.name + "</option>");
			    	  });
			    	  animalSelect.empty().append('<option value="">[[#{label.select}]]</option>');
			    	  if (options.length > 0){
			    		  for (const opt of options) {
			    			  animalSelect.append(opt);
			    		  }
			    	  }else{
			    		  animalSelect.empty().append('<option value="">[[#{label.select}]]</option>');
			    	  }
				    });
			    }else{
			    	animalSelect.empty().append('<option value="">[[#{label.select}]]</option>');
			    }
			}
		
			</script>
		
    </body>
    
</html>
